%let pgm=utl-update-in-place-sheet2-by-adding-dinner-costs-from-sheet1-preserving-excel-formatting-r;

%stop_submission;

Update in place sheet2 by adding dinner costs from sheet1 preserving excel formatting r


github
https://tinyurl.com/y5nfbfae
https://github.com/rogerjdeangelis/utl-update-in-place-sheet2-by-adding-dinner-costs-from-sheet1-preserving-excel-formatting-r


RELATED REPOS

https://github.com/rogerjdeangelis/utl-ods-excel-update-excel-sheet-in-place-python
https://github.com/rogerjdeangelis/utl-update-an-excel-workbook-in-place
https://github.com/rogerjdeangelis/utl-update-existing-excel-sheet-in-place-using-r-dcom-client
https://github.com/rogerjdeangelis/utl_excel_add_formula_inplace
https://github.com/rogerjdeangelis/utl_excel_update_inplace

/*               _     _
 _ __  _ __ ___ | |__ | | ___ _ __ ___
| `_ \| `__/ _ \| `_ \| |/ _ \ `_ ` _ \
| |_) | | | (_) | |_) | |  __/ | | | | |
| .__/|_|  \___/|_.__/|_|\___|_| |_| |_|
|_|
*/

/***************************************************************************************************************************/
/*                                                                        |                                                */
/*               INPUTS (UPDATE D:/XLS/WANT.XLSX IN PLACE)                |                  OUTPUT                        */
/*               =========================================                |                 =======                        */
/*                                                                        |                                                */
/*       ADD DINNER COSTS TO SHEET2 AND PRESERVE FORMATTING               |  ADD COLUMN DINNER TO SHEET2                   */
/*       NOTE BREAKFAST HAS BEEN FORMATTED WITH EXCEL FORMAT (00.00)      |  BREAKFAST FORMATTING WAS PRESERVED            */
/*                                                                        |                                                */
/* ---------------------+          ---------------------                  | ---------------------  ** ADD COLUMN DINNER**  */
/* | A1| fx      |DAYNUM|          | A1| fx     |DAYNUM|                  | | A1| fx     |DAYNUM|                          */
/* ------------------------------  -------------------------------------- | ---------------------------------------------- */
/* [_] |    A   |   B   |    C  |  [_] |    A  | B     |    C    |    E | | [_] |    A  | B     |    C    |    E |    C  | */
/* -----------------------------   -------------------------------------- | ---------------------------------------------  */
/*  1  | DAYNUM |  DAY  | DINNER|   1  | DAYNUM| DAY   |BREAKFAST| LUNCH| |  1  | DAYNUM| DAY   |BREAKFAST| LUNCH| DINNER| */
/*  -- |--------+-------+-------+   -- |-------+-------+---------+------+ |  -- |-------+-------+---------+------+-------+ */
/*  2  |1       |Mon    |23     |   2  |1      |Mon    |13.00    |17    | |  2  |1      |Mon    |13.00    |17    |23     | */
/*  -- |--------+-------+-------+   -- |-------+-------+---------+------+ |  -- |-------+-------+---------+------+-------+ */
/*  3  |2       |Tue    |27     |   3  |2      |Tue    |18.00    |12    | |  3  |2      |Tue    |18.00    |12    |27     | */
/*  -- |--------+-------+-------+   -- |-------+-------+---------+------+ |  -- |-------+-------+---------+------+-------+ */
/*  4  |3       |Wed    |28     |   4  |3      |Wed    |11.00    |17    | |  4  |3      |Wed    |11.00    |17    |28     | */
/*  -- |--------+-------+-------+   -- |-------+-------+---------+------+ |  -- |-------+-------+---------+------+-------+ */
/*  5  |4       |Thu    |22     |   5  |4      |Thu    |10.00    |17    | |  5  |4      |Thu    |10.00    |17    |22     | */
/*  -- |--------+-------+-------+   -- |-------+-------+---------+------+ |  -- |-------+-------+---------+------+-------+ */
/*  6  |5       |Fri    |21     |   6  |5      |Fri    |17.00    |17    | |  6  |5      |Fri    |17.00    |17    |21     | */
/*  -- |--------+-------+-------+   -- |-------+-------+---------+------+ |  -- |-------+-------+---------+------+-------+ */
/*  7  |6       |Sat    |27     |   7  |6      |Sat    |14.00    |11    | |  7  |6      |Sat    |14.00    |11    |27     | */
/*  -- |--------+-------+-------+   -- |-------+-------+---------+------+ |  -- |-------+-------+---------+------+-------+ */
/*  8  |7       |Sun    |20     |   8  |7      |Sun    |11.00    |13    | |  8  |7      |Sun    |11.00    |13    |20     | */
/*  -- |--------+-------+-------+   -- |-------+-------+---------+------+ |  -- |-------+-------+---------+------+-------+ */
/*  [SHEET1]                        [SHEET2]                              |  [SHEET2]                                      */
/*                                                                        |                                                */
/***************************************************************************************************************************/

/*                   _
(_)_ __  _ __  _   _| |_
| | `_ \| `_ \| | | | __|
| | | | | |_) | |_| | |_
|_|_| |_| .__/ \__,_|\__|
        |_|
*/

%utlfkil(d:/xls/want.xlsx);

%utl_rbeginx;
parmcards4;
library(haven)
library(openxlsx)
sheet1<-read_sas("d:/sd1/sheet1.sas7bdat")
sheet2<-read_sas("d:/sd1/sheet2.sas7bdat")
print(sheet1)
wb <- createWorkbook()
addWorksheet(wb, "sheet1")
writeData(wb, sheet = "sheet1", x = sheet1)
addWorksheet(wb, "sheet2")
 style <- createStyle(numFmt = "00.00")
 addStyle(wb, sheet = "sheet2", style = style,
   rows = 2:8, cols = 3, gridExpand = TRUE)
 writeData(wb, sheet = "sheet2", x = sheet2)
saveWorkbook(
    wb
   ,"d:/xls/want.xlsx"
   ,overwrite=TRUE)
;;;;
%utl_rendx;

/**************************************************************************************************************************/
/*                                                                                                                        */
/*                             INPUTS                                                                                     */
/*                             ======                                                                                     */
/*                                                                                                                        */
/*       NOTE BREAKFAST HAS BEEN FORMATTED WIT EXCEL FORMAT (00.00)                                                       */
/*                                                                                                                        */
/* ---------------------+                    ---------------------                                                        */
/* | A1| fx      |DAYNUM|                    | A1| fx     |DAYNUM|                                                        */
/* ------------------------------            --------------------------------------                                       */
/* [_] |    A   |   B   |    C  |            [_] |    A  | B     |    C    |   D  |                                       */
/* -----------------------------             --------------------------------------                                       */
/*  1  | DAYNUM |  DAY  | DINNER|             1  | DAYNUM| DAY   |BREAKFAST| LUNCH|                                       */
/*  -- |--------+-------+-------+             -- |-------+-------+---------+------+                                       */
/*  2  |1       |Mon    |23     |             2  |1      |Mon    |13.00    |17    |                                       */
/*  -- |--------+-------+-------+             -- |-------+-------+---------+------+                                       */
/*  3  |2       |Tue    |27     |             3  |2      |Tue    |18.00    |12    |                                       */
/*  -- |--------+-------+-------+             -- |-------+-------+---------+------+                                       */
/*  4  |3       |Wed    |28     |             4  |3      |Wed    |11.00    |17    |                                       */
/*  -- |--------+-------+-------+             -- |-------+-------+---------+------+                                       */
/*  5  |4       |Thu    |22     |             5  |4      |Thu    |10.00    |17    |                                       */
/*  -- |--------+-------+-------+             -- |-------+-------+---------+------+                                       */
/*  6  |5       |Fri    |21     |             6  |5      |Fri    |17.00    |17    |                                       */
/*  -- |--------+-------+-------+             -- |-------+-------+---------+------+                                       */
/*  7  |6       |Sat    |27     |             7  |6      |Sat    |14.00    |11    |                                       */
/*  -- |--------+-------+-------+             -- |-------+-------+---------+------+                                       */
/*  8  |7       |Sun    |20     |             8  |7      |Sun    |11.00    |13    |                                       */
/*  -- |--------+-------+-------+             -- |-------+-------+---------+------+                                       */
/*  [SHEET1]                                  [SHEET2]                                                                    */
/*                                                                                                                        */
/**************************************************************************************************************************/

/*
 _ __  _ __ ___   ___ ___  ___ ___
| `_ \| `__/ _ \ / __/ _ \/ __/ __|
| |_) | | | (_) | (_|  __/\__ \__ \
| .__/|_|  \___/ \___\___||___/___/
|_|
*/

%utl_rbeginx;
parmcards4;
library(openxlsx)
library(sqldf)
source("c:/oto/fn_tosas9x.R")
 wb<-loadWorkbook("d:/xls/want.xlsx")
 sheet1 <- readWorkbook(wb, sheet = "sheet1")
 getcol<-sqldf('
    select
      dinner
    from
      sheet1
    ')
 writeData(wb,sheet="sheet2",x=getcol,startRow=1,startCol=5,colNames=TRUE)
 saveWorkbook(
     wb
    ,"d:/xls/want.xlsx"
    ,overwrite=TRUE)
;;;;
%utl_rendx;

/**************************************************************************************************************************/
/*                                                                                                                        */
/*                   OUTPUT                                                                                               */
/*                  =======                                                                                               */
/*                                                                                                                        */
/*   ADD COLUMN DINNER TO SHEET2                                                                                          */
/*   UPDATED & BREAKFAST FORMATTING WAS PRESERVED                                                                         */
/*                                                                                                                        */
/*  ---------------------  ** ADD COLUMN DINNER**                                                                         */
/*  | A1| fx     |DAYNUM|                                                                                                 */
/*  ----------------------------------------------                                                                        */
/*  [_] |    A  | B     |    C    |    E |   D   |                                                                        */
/*  ---------------------------------------------                                                                         */
/*   1  | DAYNUM| DAY   |BREAKFAST| LUNCH| DINNER|                                                                        */
/*   -- |-------+-------+---------+------+-------+                                                                        */
/*   2  |1      |Mon    |13.00    |17    |23     |                                                                        */
/*   -- |-------+-------+---------+------+-------+                                                                        */
/*   3  |2      |Tue    |18.00    |12    |27     |                                                                        */
/*   -- |-------+-------+---------+------+-------+                                                                        */
/*   4  |3      |Wed    |11.00    |17    |28     |                                                                        */
/*   -- |-------+-------+---------+------+-------+                                                                        */
/*   5  |4      |Thu    |10.00    |17    |22     |                                                                        */
/*   -- |-------+-------+---------+------+-------+                                                                        */
/*   6  |5      |Fri    |17.00    |17    |21     |                                                                        */
/*   -- |-------+-------+---------+------+-------+                                                                        */
/*   7  |6      |Sat    |14.00    |11    |27     |                                                                        */
/*   -- |-------+-------+---------+------+-------+                                                                        */
/*   8  |7      |Sun    |11.00    |13    |20     |                                                                        */
/*   -- |-------+-------+---------+------+-------+                                                                        */
/*   [SHEET2]                                                                                                             */
/*                                                                                                                        */
/**************************************************************************************************************************/

/*              _
  ___ _ __   __| |
 / _ \ `_ \ / _` |
|  __/ | | | (_| |
 \___|_| |_|\__,_|

*/
